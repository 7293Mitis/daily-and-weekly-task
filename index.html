<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¹ã‚¿ãƒ¬ã‚¾ãƒ‡ã‚¤ãƒªãƒ¼ï¼†ã‚¦ã‚£ãƒ¼ã‚¯ãƒªãƒ¼ã‚¿ã‚¹ã‚¯</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ“‹</text></svg>">
    <style>
        :root { --daily: #e3f2fd; --weekly: #fff3e0; --fortnightly: #f3e5f5; --success: #4caf50; }
        body { font-family: "Helvetica Neue", Arial, sans-serif; background: #eee; line-height: 1.6; padding: 10px; color: #333; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h1 { text-align: center; font-size: 1.4rem; border-bottom: 3px solid #333; padding-bottom: 10px; }
        h2 { padding: 10px; border-radius: 5px; font-size: 1.1rem; margin-top: 25px; }
        .daily-h { background: var(--daily); border-left: 5px solid #2196f3; }
        .weekly-h { background: var(--weekly); border-left: 5px solid #ff9800; }
        .fort-h { background: var(--fortnightly); border-left: 5px solid #9c27b0; }
        .task-item { display: flex; align-items: center; padding: 10px; border-bottom: 1px solid #eee; }
        .sub-group { display: flex; flex-wrap: wrap; gap: 10px; margin-left: 34px; padding-bottom: 10px; border-bottom: 1px solid #eee; }
        .all-clear { font-weight: bold; color: var(--success); margin-left: 10px; display: none; }
        input[type="checkbox"] { width: 22px; height: 22px; margin-right: 12px; cursor: pointer; }
        .checked label { text-decoration: line-through; color: #888; }
        .counter-group { background: #f9f9f9; padding: 15px; border-radius: 8px; margin-top: 20px; border: 1px solid #ddd; }
        .counter-row { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px dashed #ccc; }
        .indent { padding-left: 20px; font-size: 0.9rem; color: #555; }
        .btn-box { display: flex; align-items: center; gap: 5px; }
        .counter-row input { width: 45px; text-align: center; border: 1px solid #ccc; border-radius: 4px; padding: 5px; font-size: 1rem; }
        .count-btn { width: 30px; height: 30px; border: none; background: #ddd; border-radius: 4px; cursor: pointer; font-weight: bold; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; }
        .count-btn:active { background: #bbb; }
        .target-num { font-size: 0.8rem; color: #777; width: 45px; text-align: right; }
        .info { font-size: 0.7rem; color: #888; text-align: right; line-height: 1.2; }
        .reset-btn { display: block; width: 100%; padding: 10px; margin-top: 30px; background: #ee5253; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>
<div class="container">
    <h1>ğŸ“‹ ã‚¹ã‚¿ãƒ¬ã‚¾ãƒ‡ã‚¤ãƒªãƒ¼ï¼†ã‚¦ã‚£ãƒ¼ã‚¯ãƒªãƒ¼ã‚¿ã‚¹ã‚¯</h1>
    <div id="last-reset-d" class="info"></div>
    <div id="last-reset-w" class="info"></div>

    <h2 class="daily-h">â˜€ï¸ ãƒ‡ã‚¤ãƒªãƒ¼ (5:00ãƒªã‚»ãƒƒãƒˆ)</h2>
    <div id="daily-list-base"></div>
    <div class="task-item"><strong>ä¸å®‰å®šãªç©ºé–“</strong><span id="usk-clear" class="all-clear">OK!</span></div>
    <div class="sub-group">
        <label><input type="checkbox" id="usk_1" class="save-state daily-check usk-check">1å›ç›®</label>
        <label><input type="checkbox" id="usk_2" class="save-state daily-check usk-check">2å›ç›®</label>
    </div>
    <div class="task-item"><strong>ãƒ¯ãƒ¼ãƒ«ãƒ‰ãƒœã‚¹ã®éµ</strong><span id="wbk-clear" class="all-clear">OK!</span></div>
    <div class="sub-group">
        <label><input type="checkbox" id="wbk_1" class="save-state daily-check wbk-check">1å›ç›®</label>
        <label><input type="checkbox" id="wbk_2" class="save-state daily-check wbk-check">2å›ç›®</label>
    </div>
    <div class="task-item"><strong>ç²¾é‹­ãƒ¢ãƒ–ã®éµ</strong><span id="smk-clear" class="all-clear">OK!</span></div>
    <div class="sub-group">
        <label><input type="checkbox" id="smk_1" class="save-state daily-check smk-check">1å›ç›®</label>
        <label><input type="checkbox" id="smk_2" class="save-state daily-check smk-check">2å›ç›®</label>
    </div>
    <div id="daily-list-extra"></div>

    <h2 class="weekly-h">ğŸ—“ï¸ ã‚¦ã‚£ãƒ¼ã‚¯ãƒªãƒ¼ (æœˆæ›œ5:00ãƒªã‚»ãƒƒãƒˆ)</h2>
    <div id="weekly-list-special">
        <div class="task-item"><strong>ã‚®ãƒ«ãƒ‰ãƒãƒ³ãƒˆ</strong><span id="gh-clear" class="all-clear">âœ¨All Clear!</span></div>
        <div class="sub-group">
            <label><input type="checkbox" id="gh_fri" class="save-state weekly-check gh-check">é‡‘</label>
            <label><input type="checkbox" id="gh_sat" class="save-state weekly-check gh-check">åœŸ</label>
            <label><input type="checkbox" id="gh_sun" class="save-state weekly-check gh-check">æ—¥</label>
        </div>
        <div class="task-item"><strong>ãƒ¯ãƒ¼ãƒ«ãƒ‰ãƒœã‚¹è¨ä¼æˆ¦</strong><span id="wb-clear" class="all-clear">âœ¨All Clear!</span></div>
        <div class="sub-group">
            <label><input type="checkbox" id="wb_1" class="save-state weekly-check wb-check">1</label>
            <label><input type="checkbox" id="wb_2" class="save-state weekly-check wb-check">2</label>
            <label><input type="checkbox" id="wb_3" class="save-state weekly-check wb-check">3</label>
        </div>
    </div>
    <div id="weekly-list-others"></div>

    <div class="counter-group">
        <strong>ğŸ“¦ ã‚¯ãƒ©ãƒ•ãƒˆã‚¯ãƒ©ã‚¹ç´å“çŠ¶æ³</strong>
        <div id="delivery-list" style="margin-top:10px;"></div>
    </div>

    <h2 class="fort-h">â³ éš”é€±ãƒªã‚»ãƒƒãƒˆ</h2>
    <div class="task-item"><input type="checkbox" id="f1" class="save-state"> <label for="f1">ãƒ¬ã‚°ãƒ‹ãƒ‡ã‚£ã‚¹ã®å¡”</label></div>

    <button class="reset-btn" onclick="if(confirm('å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ')) { localStorage.clear(); location.reload(); }">å…¨ãƒ‡ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆ</button>
</div>

<script>
const dailyBase = ["ç¥ç§˜ã‚¹ãƒˆã‚¢ï¼ˆç´ æè³¼å…¥ï¼‰", "ã‚®ãƒ«ãƒ‰ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³ï¼†è¼¸é€", "ãƒ›ãƒ¼ãƒ ã®ç´å“"];
const dailyExtra = ["ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãƒã‚¤ãƒ³ãƒˆ(400)", "ã‚·ãƒ¼ã‚ºãƒ³ã‚»ãƒ³ã‚¿ãƒ¼(500pt)"];
const weeklyOthers = ["é–‹æ‹“è€…å ±é…¬", "è£œå¡«ã‚·ãƒ§ãƒƒãƒ—", "ã‚®ãƒ«ãƒ‰æ´»å‹•å ±é…¬", "ã‚®ãƒ«ãƒ‰ãƒ€ãƒ³ã‚¹(é‡‘æ›œ)", "ã‚®ãƒ«ãƒ‰ã‚¹ãƒˆã‚¢", "GCã‚¹ãƒˆã‚¢", "å‹æƒ…ã‚¹ãƒˆã‚¢", "åå£°ã‚¹ãƒˆã‚¢"];

const deliveryItems = [
    {n:"ç²˜åœŸ", q:160}, {n:"ç´°ç ‚", q:160}, {n:"æ¸…ã‚‰ã‹ãªæ¹§æ°´", q:200}, {n:"é‡‘å±ç ‚", q:80}, {n:"å²©å¡©", q:80},
    {n:"é‰„ã‚¤ãƒ³ã‚´ãƒƒãƒˆ", q:40, sub:[{n:"é‰„é‰±çŸ³", q:40}, {n:"çŸ³ç‚­", q:80}]},
    {n:"ç ‚å²©ã®ç ¥çŸ³", q:40, sub:[{n:"çŸ³ç°å²©ã®åŸçŸ³", q:80}]},
    {n:"å°éº¦ç²‰", q:45, sub:[{n:"å°éº¦", q:135}]},
    {n:"æ¾æ", q:40, sub:[{n:"æ¾ã®åŸæœ¨", q:120}]},
    {n:"è¬ã®çŸ³ã®ç²‰", q:40, sub:[{n:"è¬ã®çŸ³ã®åŸçŸ³", q:160}, {n:"æœ¨ã®æ", q:200}]},
    {n:"æ”¹è‰¯ç¶¿å¸ƒ", q:20, sub:[{n:"æ”¹è‰¯ç¹”ã‚Šç³¸", q:200}, {n:"äºœéº»", q:67}]}
];

function setup() {
    const dBase = document.getElementById('daily-list-base');
    dailyBase.forEach((t, i) => dBase.innerHTML += `<div class="task-item"><input type="checkbox" id="dbase${i}" class="save-state daily-check"> <label for="dbase${i}">${t}</label></div>`);
    const dExtra = document.getElementById('daily-list-extra');
    dailyExtra.forEach((t, i) => dExtra.innerHTML += `<div class="task-item"><input type="checkbox" id="dextra${i}" class="save-state daily-check"> <label for="dextra${i}">${t}</label></div>`);
    const wListO = document.getElementById('weekly-list-others');
    weeklyOthers.forEach((t, i) => wListO.innerHTML += `<div class="task-item"><input type="checkbox" id="w${i}" class="save-state weekly-check"> <label for="w${i}">${t}</label></div>`);
    
    const delList = document.getElementById('delivery-list');
    deliveryItems.forEach((item, i) => {
        delList.innerHTML += createCounterRow(item, `main${i}`);
        if(item.sub) item.sub.forEach((s, j) => delList.innerHTML += createCounterRow(s, `sub${i}_${j}`, true));
    });

    loadStates();
    checkResets();
    refreshAllStatus();
}

function createCounterRow(item, id, isSub = false) {
    const storageId = `val_${id}`;
    return `
        <div class="counter-row ${isSub ? 'indent' : ''}">
            <span>${isSub ? 'â”” ' : ''}${item.n}</span>
            <div class="btn-box">
                <button class="count-btn" onclick="changeCount('${storageId}', -1)">-</button>
                <input type="number" id="${storageId}" class="save-val" value="0" min="0" onchange="localStorage.setItem('${storageId}', this.value)">
                <button class="count-btn" onclick="changeCount('${storageId}', 1)">+</button>
                <span class="target-num">/ ${item.q}</span>
            </div>
        </div>`;
}

function changeCount(id, val) {
    const input = document.getElementById(id);
    input.value = Math.max(0, parseInt(input.value) + val);
    localStorage.setItem(id, input.value);
}

function loadStates() {
    document.querySelectorAll('.save-state').forEach(el => {
        el.checked = localStorage.getItem(el.id) === 'true';
        if(el.checked) el.parentElement.classList.add('checked');
        el.onchange = () => {
            localStorage.setItem(el.id, el.checked);
            el.parentElement.classList.toggle('checked', el.checked);
            refreshAllStatus();
        };
    });
    document.querySelectorAll('.save-val').forEach(el => el.value = localStorage.getItem(el.id) || 0);
}

function refreshAllStatus() {
    const groups = [['gh-check', 'gh-clear'], ['wb-check', 'wb-clear'], ['wbk-check', 'wbk-clear'], ['smk-check', 'smk-clear'], ['usk-check', 'usk-clear']];
    groups.forEach(g => {
        const checks = document.querySelectorAll('.' + g[0]);
        if(checks.length) document.getElementById(g[1]).style.display = Array.from(checks).every(c => c.checked) ? 'inline' : 'none';
    });
}

function checkResets() {
    const now = new Date();
    // ãƒ‡ã‚¤ãƒªãƒ¼ãƒªã‚»ãƒƒãƒˆåˆ¤å®š (æ¯æ—¥5:00)
    let dReset = new Date(); dReset.setHours(5, 0, 0, 0);
    if (now < dReset) dReset.setDate(dReset.getDate() - 1);
    
    // ã‚¦ã‚£ãƒ¼ã‚¯ãƒªãƒ¼ãƒªã‚»ãƒƒãƒˆåˆ¤å®š (æœˆæ›œ5:00)
    let wReset = new Date(); wReset.setHours(5, 0, 0, 0);
    let day = wReset.getDay(); // 0:æ—¥, 1:æœˆ...
    let diff = (day >= 1) ? day - 1 : 6;
    wReset.setDate(wReset.getDate() - diff);
    if (now < wReset) wReset.setDate(wReset.getDate() - 7);

    const lastD = localStorage.getItem('lastDaily');
    const lastW = localStorage.getItem('lastWeekly');

    if (!lastD || new Date(lastD) < dReset) {
        document.querySelectorAll('.daily-check').forEach(cb => { cb.checked = false; cb.parentElement.classList.remove('checked'); localStorage.setItem(cb.id, false); });
        localStorage.setItem('lastDaily', now.toISOString());
    }
    if (!lastW || new Date(lastW) < wReset) {
        document.querySelectorAll('.weekly-check').forEach(cb => { cb.checked = false; cb.parentElement.classList.remove('checked'); localStorage.setItem(cb.id, false); });
        // ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚‚æœˆæ›œã«ãƒªã‚»ãƒƒãƒˆ
        document.querySelectorAll('.save-val').forEach(input => { input.value = 0; localStorage.setItem(input.id, 0); });
        localStorage.setItem('lastWeekly', now.toISOString());
    }
    document.getElementById('last-reset-d').innerText = "ãƒ‡ã‚¤ãƒªãƒ¼æ›´æ–°: " + new Date(localStorage.getItem('lastDaily')).toLocaleString();
    document.getElementById('last-reset-w').innerText = "ã‚¦ã‚£ãƒ¼ã‚¯ãƒªãƒ¼æ›´æ–°: " + new Date(localStorage.getItem('lastWeekly')).toLocaleString();
}
setup();
</script>
</body>
</html>
